# Слушатель

## Web

Структура:

```json
{
  "subject": "<>",
  "payload": {}
}
```

Справочник `payload.type`:

| Code           | Description                                                                                    |
|----------------|------------------------------------------------------------------------------------------------|
| state          | состояние звонка                                                                               |
| greet          | приветствие оператора                                                                          |
| chat           | текстовое сообщение в чате                                                                     |
| feedback       | оценка звонка клиентом                                                                         |

Справочник `payload.data.state` при `payload.type = state`:

| Code           | Description                                                                                    |
|----------------|------------------------------------------------------------------------------------------------|
| ringing        | дозвон до оператора                                                                            |
| cancelled      | отмена звонка клиентом вручную или автоматическая отмена звонка, если нет доступного оператора |
| connected      | установлено успешное соединение между клиентом и оператором                                    |
| disconnected   | отключение оператора от соединения                                                             |
| redirected     | начало перенаправления звонка на другого оператора                                             |
| ended          | успешная остановка звонка после FINISH от клиента                                              |
| closed         | клиент закрыл окно виджета в завершенном звонке                                                |

## Android/iOS/Flutter

Справочник:

| Code           | Description                                                                                    |
|----------------|------------------------------------------------------------------------------------------------|
| RINGING        | дозвон до оператора                                                                            |
| CANCELLED      | отмена звонка клиентом вручную или автоматическая отмена звонка, если нет доступного оператора |
| GREET          | приветствие оператора                                                                          |
| START          | начало соединения между клиентом и оператором                                                  |
| CONNECTED      | установлено успешное соединение между клиентом и оператором                                    |
| REDIRECTED     | начало перенаправления звонка на другого оператора                                             |
| DISCONNECTED   | отключение оператора от соединения                                                             |
| FINISH         | завершение звонка клиентом или оператором                                                      |
| ENDED          | успешная остановка звонка после FINISH от клиента                                              |
| FEEDBACK_SKIP  | пропуск оценки звонка клиентом                                                                 |
| FEEDBACK_RATE  | оценка звонка клиентом                                                                         |
| CLOSED         | закрытие страницы клиентом                                                                     |
